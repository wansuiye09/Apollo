- type: parallel
  steps:
    - name: Apollo Core tests
      service: apollo-core-test
      command: mix test

    - name: Apollo Web tests
      service: apollo-web-test
      command: mix test

    - name: Apollo test coverage
      service: apollo-base-test
      tag: master
      command: mix coveralls.post --umbrella --token $COVERALLS_REPO_TOKEN --branch $CI_BRANCH --name $CI_NAME --commiter $CI_COMMITTER_NAME --sha $CI_COMMIT_ID --message $CI_COMMIT_MESSAGE

    - name: Apollo lint check
      service: apollo-base-test
      command: mix format --check-formatted --dry-run

    - name: Steno tests
      service: steno-test
      command: npm test

    - name: Steno lint check
      service: steno-test
      command: npm run lint:js
